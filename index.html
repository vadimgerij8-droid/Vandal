<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
    <title>SAYS UA ¬∑ –∂–∏–≤–∏–π –∫—ñ–Ω–æ—Ç–µ–∞—Ç—Ä</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* –°—Ç–∏–ª—ñ (—Ç—ñ —Å–∞–º—ñ, —â–æ –π —Ä–∞–Ω—ñ—à–µ, –¥–ª—è –µ–∫–æ–Ω–æ–º—ñ—ó –º—ñ—Å—Ü—è –∑–∞–ª–∏—à–∞—é —Å–∫–æ—Ä–æ—á–µ–Ω–æ, –∞–ª–µ –≤ —Ä–æ–±–æ—á–æ–º—É –∫–æ–¥—ñ –º–∞—é—Ç—å –±—É—Ç–∏ –ø–æ–≤–Ω—ñ) */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background-color: #0a0a0a; color: #e5e5e5; font-family: 'Inter', sans-serif; }
        .app { max-width: 1440px; margin: 0 auto; padding: 0 16px; }
        .header { position: sticky; top: 0; z-index: 1000; background-color: rgba(10,10,10,0.98); backdrop-filter: blur(10px); padding: 12px 0; }
        .header-top { display: flex; align-items: center; gap: 8px; flex-wrap: wrap; }
        .logo { font-size: 1.8rem; font-weight: 800; color: white; }
        .menu-toggle { display: none; font-size: 1.8rem; background: none; border: none; color: white; }
        .search-box { display: flex; align-items: center; background: #1a1a1a; border-radius: 40px; padding: 10px 16px; flex: 1; min-width: 200px; border: 1px solid #333; }
        .search-box i { color: #777; margin-right: 8px; }
        .search-box input { background: transparent; border: none; color: white; width: 100%; outline: none; }
        .user-icon { font-size: 1.8rem; color: #ccc; cursor: pointer; }
        .nav-links { display: flex; gap: 24px; border-bottom: 1px solid #222; padding: 8px 0; }
        .nav-links a { color: #aaa; text-decoration: none; cursor: pointer; padding: 4px 0; }
        .nav-links a.active { color: white; border-bottom: 2px solid white; }
        .filter-section { margin: 20px 0; display: flex; flex-direction: column; gap: 16px; }
        .genre-chips { display: flex; overflow-x: auto; gap: 10px; padding: 4px 0; -webkit-overflow-scrolling: touch; white-space: nowrap; }
        .chip { background: #1a1a1a; border: 1px solid #333; color: #ccc; padding: 10px 20px; border-radius: 40px; font-size: 0.95rem; cursor: pointer; flex-shrink: 0; }
        .chip.active { background: white; color: black; border-color: white; }
        .sort-control select { background: #1a1a1a; border: 1px solid #333; color: white; padding: 12px 32px 12px 16px; border-radius: 40px; appearance: none; background-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='20' height='20' viewBox='0 0 24 24' fill='none' stroke='white'><polyline points='6 9 12 15 18 9'/></svg>"); background-repeat: no-repeat; background-position: right 12px center; }
        .movies-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 16px; margin: 20px 0 30px; }
        .movie-card { background: #121212; border-radius: 16px; overflow: hidden; border: 1px solid #252525; cursor: pointer; transition: transform 0.2s; }
        .movie-card:active { transform: scale(0.97); }
        .card-poster { aspect-ratio: 2/3; background: linear-gradient(145deg,#2a2a2a,#1a1a1a); display: flex; align-items: center; justify-content: center; color: #555; font-size: 2.5rem; position: relative; }
        .card-poster img { width: 100%; height: 100%; object-fit: cover; display: block; }
        .card-badge { position: absolute; top: 8px; right: 8px; background: rgba(255,255,255,0.9); color: black; padding: 4px 8px; border-radius: 30px; font-size: 0.7rem; }
        .card-info { padding: 12px; }
        .card-title { font-weight: 600; font-size: 0.95rem; color: white; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
        .card-meta { display: flex; gap: 8px; margin: 8px 0; font-size: 0.8rem; }
        .card-year { background: #1f1f1f; padding: 4px 12px; border-radius: 30px; }
        .card-imdb { background: #2b2b2b; padding: 4px 12px; border-radius: 30px; color: #f5c518; }
        .card-genres { display: flex; flex-wrap: wrap; gap: 6px; }
        .genre-tag { background: #1a1a1a; color: #bbb; font-size: 0.7rem; padding: 4px 10px; border-radius: 30px; border: 1px solid #2f2f2f; }
        .card-type { font-size: 0.7rem; color: #777; margin-top: 8px; }
        .modal { display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.95); z-index: 2000; flex-direction: column; padding: 16px; }
        .modal.active { display: flex; }
        .modal-header { display: flex; justify-content: space-between; align-items: center; color: white; margin-bottom: 20px; }
        .modal-close { font-size: 2rem; cursor: pointer; padding: 8px; }
        .modal-content { display: flex; flex-direction: column; gap: 20px; overflow-y: auto; flex: 1; }
        .modal-poster { width: 150px; border-radius: 12px; align-self: center; }
        .modal-info { color: #ccc; }
        .modal-info h3 { color: white; margin-bottom: 8px; }
        .modal-info p { margin-bottom: 12px; line-height: 1.6; }
        .trailer-container { width: 100%; aspect-ratio: 16/9; background: black; border-radius: 12px; overflow: hidden; }
        .trailer-container iframe { width: 100%; height: 100%; border: none; }
        .modal-actions { display: flex; gap: 16px; justify-content: center; margin-top: 20px; }
        .modal-btn { background: #1a1a1a; border: 1px solid #333; color: white; padding: 12px 24px; border-radius: 40px; font-size: 1rem; display: flex; align-items: center; gap: 8px; cursor: pointer; }
        .footer { border-top: 1px solid #222; padding: 30px 0; display: flex; flex-wrap: wrap; justify-content: space-between; color: #666; }
        .footer a { color: #aaa; text-decoration: none; cursor: pointer; margin-right: 24px; }
        @media (max-width: 768px) {
            .menu-toggle { display: block; }
            .nav-links { display: none; flex-direction: column; position: absolute; top: 100%; left: 0; right: 0; background: #0a0a0a; padding: 20px; border-bottom: 1px solid #333; }
            .nav-links.mobile-open { display: flex; }
            .search-box { order: 3; width: 100%; max-width: 100%; }
        }
        .no-results { grid-column: 1/-1; text-align: center; padding: 40px; color: #666; }
        .spinner { text-align: center; padding: 40px; font-size: 2rem; color: #666; }
        .error-message { color: #ff6b6b; text-align: center; padding: 20px; font-size: 1.2rem; }
    </style>
</head>
<body>
<div class="app">
    <header class="header">
        <div class="header-top">
            <div class="logo">SAYS UA</div>
            <button class="menu-toggle" id="menuToggle"><i class="fas fa-bars"></i></button>
            <div class="search-box">
                <i class="fas fa-search"></i>
                <input type="search" id="searchInput" placeholder="–ü–æ—à—É–∫ —Ñ—ñ–ª—å–º—ñ–≤, —Å–µ—Ä—ñ–∞–ª—ñ–≤...">
            </div>
            <div class="user-icon" id="userIcon"><i class="far fa-user-circle"></i></div>
        </div>
        <div class="nav-links" id="navLinks">
            <a data-nav="home" class="active">–ì–æ–ª–æ–≤–Ω–∞</a>
            <a data-nav="movies">–§—ñ–ª—å–º–∏</a>
            <a data-nav="series">–°–µ—Ä—ñ–∞–ª–∏</a>
            <a data-nav="collections">–î–æ–±—ñ—Ä–∫–∏</a>
            <a data-nav="ratings">–†–µ–π—Ç–∏–Ω–≥–∏</a>
        </div>
    </header>

    <div class="filter-section">
        <div class="genre-chips" id="genreChips"></div>
        <div class="sort-control">
            <select id="sortSelect">
                <option value="popular">–ü–æ–ø—É–ª—è—Ä–Ω—ñ</option>
                <option value="rating">–ó–∞ —Ä–µ–π—Ç–∏–Ω–≥–æ–º</option>
                <option value="year">–ù–æ–≤–∏–Ω–∫–∏</option>
            </select>
        </div>
    </div>

    <main>
        <div class="movies-grid" id="moviesGrid"></div>
    </main>

    <!-- –ú–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ –¥–µ—Ç–∞–ª–µ–π —Ñ—ñ–ª—å–º—É -->
    <div class="modal" id="detailsModal">
        <div class="modal-header">
            <h2 id="modalTitle"></h2>
            <span class="modal-close" id="modalClose">&times;</span>
        </div>
        <div class="modal-content" id="modalContent"></div>
    </div>

    <footer class="footer">
        <div>¬© 2025 SAYS UA ‚Äî –∫—ñ–Ω–æ—Ç–µ–∞—Ç—Ä –Ω–∞ –±–∞–∑—ñ TMDB</div>
        <div>
            <a id="footerAbout">–ü—Ä–æ –Ω–∞—Å</a>
            <a id="footerApi">API</a>
            <a id="footerSupport">–ü—ñ–¥—Ç—Ä–∏–º–∫–∞</a>
        </div>
    </footer>
</div>

<script>
    (function() {
        // ‚ö†Ô∏è –í–ê–® –ö–õ–Æ–ß TMDB (–æ–±–æ–≤'—è–∑–∫–æ–≤–æ –≤—Å—Ç–∞–≤—Ç–µ —Å—é–¥–∏)
        // –û—Ç—Ä–∏–º–∞–π—Ç–µ —Ç–æ–∫–µ–Ω –Ω–∞ https://www.themoviedb.org/settings/api
        const TMDB_TOKEN = 'eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiI5ZjQyNjQ2ZTY2YzE1ZmM2MzRkOTUzZjE4YzE2YzMxMSIsIm5iZiI6MTc0MDIyMTI2Ny4wNTEsInN1YiI6IjY3YjlkOGIzYjQ5YjA2MDcyMzE3ZDRhYyIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.2VvJk6GcAC0rYf7AS7H0BEPwSJETt_SQ74t7rBcV7Cg'; // –∑–∞–º—ñ–Ω—ñ—Ç—å –Ω–∞ –≤–∞—à —Ä–µ–∞–ª—å–Ω–∏–π —Ç–æ–∫–µ–Ω

        if (!TMDB_TOKEN || TMDB_TOKEN === '–≤–∞—à_—Ç–æ–∫–µ–Ω_v4') {
            document.getElementById('moviesGrid').innerHTML = '<div class="error-message">‚ùå –ë—É–¥—å –ª–∞—Å–∫–∞, –≤—Å—Ç–∞–≤—Ç–µ –¥—ñ–π—Å–Ω–∏–π —Ç–æ–∫–µ–Ω TMDB —É –∫–æ–¥—ñ (—Ä—è–¥–æ–∫ const TMDB_TOKEN).</div>';
            return;
        }

        const API_BASE = 'https://api.themoviedb.org/3';
        const IMG_BASE = 'https://image.tmdb.org/t/p/w500';

        // –°—Ç–∞–Ω
        let activeGenre = null; // id –∂–∞–Ω—Ä—É
        let currentSort = 'popular';
        let activeNav = 'home';
        let searchQuery = '';
        let genresList = [];
        let currentPage = 1;
        let isLoading = false;
        let totalPages = 1;

        // DOM
        const grid = document.getElementById('moviesGrid');
        const chipsContainer = document.getElementById('genreChips');
        const sortSelect = document.getElementById('sortSelect');
        const searchInput = document.getElementById('searchInput');
        const navLinks = document.querySelectorAll('#navLinks a');
        const menuToggle = document.getElementById('menuToggle');
        const mobileMenu = document.getElementById('navLinks');
        const modal = document.getElementById('detailsModal');
        const modalClose = document.getElementById('modalClose');
        const modalTitle = document.getElementById('modalTitle');
        const modalContent = document.getElementById('modalContent');
        const userIcon = document.getElementById('userIcon');
        const footerAbout = document.getElementById('footerAbout');
        const footerApi = document.getElementById('footerApi');
        const footerSupport = document.getElementById('footerSupport');

        // –§—É–Ω–∫—Ü—ñ—ó API –∑ –æ–±—Ä–æ–±–∫–æ—é –ø–æ–º–∏–ª–æ–∫
        async function fetchFromTMDB(endpoint, params = {}) {
            const url = new URL(API_BASE + endpoint);
            Object.keys(params).forEach(key => url.searchParams.append(key, params[key]));
            
            try {
                const response = await fetch(url, {
                    headers: {
                        'Authorization': `Bearer ${TMDB_TOKEN}`,
                        'Content-Type': 'application/json;charset=utf-8'
                    }
                });
                
                if (!response.ok) {
                    let errorText = await response.text();
                    throw new Error(`HTTP ${response.status}: ${response.statusText}\n${errorText}`);
                }
                return await response.json();
            } catch (error) {
                console.error('Fetch error:', error);
                throw error;
            }
        }

        // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∂–∞–Ω—Ä—ñ–≤
        async function loadGenres() {
            try {
                const movieGenres = await fetchFromTMDB('/genre/movie/list');
                const tvGenres = await fetchFromTMDB('/genre/tv/list');
                const all = [...movieGenres.genres, ...tvGenres.genres];
                const unique = new Map(all.map(g => [g.id, g]));
                genresList = Array.from(unique.values());
                renderChips();
            } catch (e) {
                console.error('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∂–∞–Ω—Ä—ñ–≤', e);
                chipsContainer.innerHTML = '<span class="chip active">–£—Å—ñ</span>';
            }
        }

        function renderChips() {
            chipsContainer.innerHTML = '<span class="chip active" data-genre-id="all">–£—Å—ñ</span>';
            genresList.forEach(genre => {
                const chip = document.createElement('span');
                chip.className = 'chip';
                chip.textContent = genre.name;
                chip.dataset.genreId = genre.id;
                chip.addEventListener('click', () => {
                    document.querySelectorAll('.chip').forEach(c => c.classList.remove('active'));
                    chip.classList.add('active');
                    activeGenre = chip.dataset.genreId === 'all' ? null : parseInt(chip.dataset.genreId);
                    currentPage = 1;
                    loadContent(true);
                });
                chipsContainer.appendChild(chip);
            });
        }

        // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∫–æ–Ω—Ç–µ–Ω—Ç—É
        async function loadContent(resetGrid = true) {
            if (isLoading) return;
            if (resetGrid) {
                grid.innerHTML = '<div class="spinner"><i class="fas fa-spinner fa-spin"></i> –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</div>';
                currentPage = 1;
            }

            isLoading = true;
            try {
                let endpoint = '';
                let params = { page: currentPage };

                // –í–∏–∑–Ω–∞—á–∞—î–º–æ —Ç–∏–ø –∫–æ–Ω—Ç–µ–Ω—Ç—É —Ç–∞ endpoint
                if (activeNav === 'home' || activeNav === 'movies') {
                    if (currentSort === 'popular') endpoint = '/movie/popular';
                    else if (currentSort === 'rating') endpoint = '/movie/top_rated';
                    else if (currentSort === 'year') endpoint = '/movie/now_playing';
                } else if (activeNav === 'series') {
                    if (currentSort === 'popular') endpoint = '/tv/popular';
                    else if (currentSort === 'rating') endpoint = '/tv/top_rated';
                    else if (currentSort === 'year') endpoint = '/tv/on_the_air';
                } else if (activeNav === 'collections') {
                    endpoint = '/trending/all/week';
                } else if (activeNav === 'ratings') {
                    endpoint = '/movie/top_rated';
                }

                // –ü–æ—à—É–∫ –ø–µ—Ä–µ–∫—Ä–∏–≤–∞—î –≤—Å–µ
                if (searchQuery.trim()) {
                    endpoint = '/search/multi';
                    params.query = searchQuery;
                }

                // –î–æ–¥–∞—î–º–æ —Ñ—ñ–ª—å—Ç—Ä –∑–∞ –∂–∞–Ω—Ä–æ–º (—è–∫—â–æ –≤–∏–±—Ä–∞–Ω–æ)
                if (activeGenre && !searchQuery) {
                    params.with_genres = activeGenre;
                }

                const data = await fetchFromTMDB(endpoint, params);
                totalPages = data.total_pages || 1;

                if (resetGrid) {
                    displayMovies(data.results);
                } else {
                    appendMovies(data.results);
                }
            } catch (e) {
                grid.innerHTML = `<div class="error-message">‚ùå –ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è: ${e.message}</div>`;
            } finally {
                isLoading = false;
            }
        }

        function displayMovies(items) {
            if (!items || items.length === 0) {
                grid.innerHTML = '<div class="no-results">üòï –ù—ñ—á–æ–≥–æ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ</div>';
                return;
            }

            let html = '';
            items.forEach(item => {
                const title = item.title || item.name || '–ë–µ–∑ –Ω–∞–∑–≤–∏';
                const year = (item.release_date || item.first_air_date || '').slice(0, 4) || 'N/A';
                const rating = item.vote_average ? item.vote_average.toFixed(1) : '‚Äî';
                const poster = item.poster_path ? IMG_BASE + item.poster_path : null;
                const mediaType = item.media_type || (item.title ? 'movie' : 'tv');

                html += `
                    <div class="movie-card" data-id="${item.id}" data-type="${mediaType}">
                        <div class="card-poster">
                            ${poster ? `<img src="${poster}" alt="${title}" loading="lazy">` : `<span>${title.slice(0,2)}</span>`}
                            ${mediaType === 'tv' ? '<span class="card-badge"><i class="fas fa-tv"></i> –°–µ—Ä—ñ–∞–ª</span>' : ''}
                        </div>
                        <div class="card-info">
                            <div class="card-title">${title}</div>
                            <div class="card-meta">
                                <span class="card-year">${year}</span>
                                <span class="card-imdb"><i class="fab fa-imdb"></i> ${rating}</span>
                            </div>
                            <div class="card-genres">
                                ${item.genre_ids ? item.genre_ids.slice(0,2).map(id => {
                                    const g = genresList.find(g => g.id === id);
                                    return g ? `<span class="genre-tag">${g.name}</span>` : '';
                                }).join('') : ''}
                            </div>
                            <div class="card-type">${mediaType === 'movie' ? '–§—ñ–ª—å–º' : '–°–µ—Ä—ñ–∞–ª'}</div>
                        </div>
                    </div>
                `;
            });
            grid.innerHTML = html;

            // –û–±—Ä–æ–±–Ω–∏–∫–∏ –∫–ª—ñ–∫—ñ–≤
            document.querySelectorAll('.movie-card').forEach(card => {
                card.addEventListener('click', () => {
                    const id = card.dataset.id;
                    const type = card.dataset.type;
                    showDetails(id, type);
                });
            });
        }

        function appendMovies(items) {
            if (!items || items.length === 0) return;
            let html = '';
            items.forEach(item => {
                const title = item.title || item.name || '–ë–µ–∑ –Ω–∞–∑–≤–∏';
                const year = (item.release_date || item.first_air_date || '').slice(0, 4) || 'N/A';
                const rating = item.vote_average ? item.vote_average.toFixed(1) : '‚Äî';
                const poster = item.poster_path ? IMG_BASE + item.poster_path : null;
                const mediaType = item.media_type || (item.title ? 'movie' : 'tv');

                html += `
                    <div class="movie-card" data-id="${item.id}" data-type="${mediaType}">
                        <div class="card-poster">
                            ${poster ? `<img src="${poster}" alt="${title}" loading="lazy">` : `<span>${title.slice(0,2)}</span>`}
                            ${mediaType === 'tv' ? '<span class="card-badge"><i class="fas fa-tv"></i> –°–µ—Ä—ñ–∞–ª</span>' : ''}
                        </div>
                        <div class="card-info">
                            <div class="card-title">${title}</div>
                            <div class="card-meta">
                                <span class="card-year">${year}</span>
                                <span class="card-imdb"><i class="fab fa-imdb"></i> ${rating}</span>
                            </div>
                            <div class="card-genres">
                                ${item.genre_ids ? item.genre_ids.slice(0,2).map(id => {
                                    const g = genresList.find(g => g.id === id);
                                    return g ? `<span class="genre-tag">${g.name}</span>` : '';
                                }).join('') : ''}
                            </div>
                            <div class="card-type">${mediaType === 'movie' ? '–§—ñ–ª—å–º' : '–°–µ—Ä—ñ–∞–ª'}</div>
                        </div>
                    </div>
                `;
            });
            grid.insertAdjacentHTML('beforeend', html);

            // –î–æ–¥–∞—î–º–æ –æ–±—Ä–æ–±–Ω–∏–∫–∏ –¥–æ –Ω–æ–≤–∏—Ö –∫–∞—Ä—Ç–æ–∫
            document.querySelectorAll('.movie-card:not([data-listener])').forEach(card => {
                card.setAttribute('data-listener', 'true');
                card.addEventListener('click', () => {
                    const id = card.dataset.id;
                    const type = card.dataset.type;
                    showDetails(id, type);
                });
            });
        }

        async function showDetails(id, type) {
            try {
                modalTitle.textContent = '–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...';
                modalContent.innerHTML = '<div class="spinner"><i class="fas fa-spinner fa-spin"></i></div>';
                modal.classList.add('active');

                const endpoint = type === 'movie' ? `/movie/${id}` : `/tv/${id}`;
                const details = await fetchFromTMDB(endpoint, { append_to_response: 'videos,credits' });

                const title = details.title || details.name;
                const year = (details.release_date || details.first_air_date || '').slice(0, 4);
                const rating = details.vote_average ? details.vote_average.toFixed(1) : '‚Äî';
                const poster = details.poster_path ? IMG_BASE + details.poster_path : null;
                const overview = details.overview || '–û–ø–∏—Å –≤—ñ–¥—Å—É—Ç–Ω—ñ–π.';
                const trailer = details.videos?.results?.find(v => v.type === 'Trailer' && v.site === 'YouTube');

                modalTitle.textContent = title;

                let trailerHtml = '';
                if (trailer) {
                    trailerHtml = `
                        <div class="trailer-container">
                            <iframe src="https://www.youtube.com/embed/${trailer.key}" allowfullscreen></iframe>
                        </div>
                    `;
                } else {
                    trailerHtml = '<p style="color:#777;">–¢—Ä–µ–π–ª–µ—Ä –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ</p>';
                }

                modalContent.innerHTML = `
                    <div style="display: flex; flex-direction: column; gap: 20px;">
                        ${poster ? `<img src="${poster}" alt="${title}" class="modal-poster">` : ''}
                        <div class="modal-info">
                            <p><strong>–†—ñ–∫:</strong> ${year}</p>
                            <p><strong>–†–µ–π—Ç–∏–Ω–≥:</strong> ‚≠ê ${rating}</p>
                            <p><strong>–û–ø–∏—Å:</strong> ${overview}</p>
                            <p><strong>–ê–∫—Ç–æ—Ä–∏:</strong> ${details.credits?.cast?.slice(0,5).map(c => c.name).join(', ') || '‚Äî'}</p>
                        </div>
                        ${trailerHtml}
                        <div class="modal-actions">
                            <button class="modal-btn" id="addToFavBtn"><i class="far fa-heart"></i> –í –æ–±—Ä–∞–Ω–µ</button>
                        </div>
                    </div>
                `;

                document.getElementById('addToFavBtn')?.addEventListener('click', () => {
                    let favs = JSON.parse(localStorage.getItem('saysua_favorites')) || [];
                    if (!favs.includes(id)) {
                        favs.push(id);
                        localStorage.setItem('saysua_favorites', JSON.stringify(favs));
                        alert('–î–æ–¥–∞–Ω–æ –¥–æ —É–ª—é–±–ª–µ–Ω–∏—Ö!');
                    } else {
                        alert('–í–∂–µ –≤ —É–ª—é–±–ª–µ–Ω–∏—Ö');
                    }
                });

            } catch (e) {
                modalContent.innerHTML = `<div class="error-message">–ü–æ–º–∏–ª–∫–∞: ${e.message}</div>`;
            }
        }

        // –ù–∞–≤—ñ–≥–∞—Ü—ñ—è
        function setActiveNav(target) {
            navLinks.forEach(link => {
                const nav = link.dataset.nav;
                link.classList.toggle('active', nav === target);
            });
        }

        navLinks.forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                activeNav = link.dataset.nav;
                setActiveNav(activeNav);
                activeGenre = null;
                searchQuery = '';
                searchInput.value = '';
                renderChips();
                currentPage = 1;
                loadContent(true);
                mobileMenu.classList.remove('mobile-open');
            });
        });

        // –°–æ—Ä—Ç—É–≤–∞–Ω–Ω—è
        sortSelect.addEventListener('change', (e) => {
            currentSort = e.target.value;
            currentPage = 1;
            loadContent(true);
        });

        // –ü–æ—à—É–∫
        let searchTimeout;
        searchInput.addEventListener('input', (e) => {
            clearTimeout(searchTimeout);
            searchTimeout = setTimeout(() => {
                searchQuery = e.target.value;
                currentPage = 1;
                loadContent(true);
            }, 500);
        });

        // –ú–æ–±—ñ–ª—å–Ω–µ –º–µ–Ω—é
        menuToggle.addEventListener('click', () => {
            mobileMenu.classList.toggle('mobile-open');
        });

        // –ó–∞–∫—Ä–∏—Ç—Ç—è –º–æ–¥–∞–ª–∫–∏
        modalClose.addEventListener('click', () => {
            modal.classList.remove('active');
        });
        modal.addEventListener('click', (e) => {
            if (e.target === modal) modal.classList.remove('active');
        });

        // –Ü–∫–æ–Ω–∫–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
        userIcon.addEventListener('click', () => {
            const favs = JSON.parse(localStorage.getItem('saysua_favorites')) || [];
            alert(`üë§ –£–ª—é–±–ª–µ–Ω–∏—Ö —Ñ—ñ–ª—å–º—ñ–≤: ${favs.length}`);
        });

        // –§—É—Ç–µ—Ä
        footerAbout.addEventListener('click', () => alert('SAYS UA –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î TMDB API. –£—Å—ñ –ø—Ä–∞–≤–∞ –Ω–∞ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –Ω–∞–ª–µ–∂–∞—Ç—å —ó—Ö–Ω—ñ–º –≤–ª–∞—Å–Ω–∏–∫–∞–º.'));
        footerApi.addEventListener('click', () => alert('–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è TMDB API. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è: https://developers.themoviedb.org/3'));
        footerSupport.addEventListener('click', () => alert('–ù–∞–ø–∏—à—ñ—Ç—å –Ω–∞–º: support@saysua.example'));

        // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è
        loadGenres().then(() => loadContent(true));
        setActiveNav('home');

        // –ù–µ—Å–∫—ñ–Ω—á–µ–Ω–Ω–∞ –ø—Ä–æ–∫—Ä—É—Ç–∫–∞
        window.addEventListener('scroll', () => {
            if (window.innerHeight + window.scrollY >= document.body.offsetHeight - 500 && !isLoading && currentPage < totalPages) {
                currentPage++;
                loadContent(false);
            }
        });
    })();
</script>
</body>
</html>
